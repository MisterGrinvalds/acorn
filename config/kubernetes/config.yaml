# Kubernetes component configuration
name: kubernetes
description: Kubernetes and Helm development tools
version: 1.0.0

# Environment variables
env:
  KUBECONFIG: "${KUBECONFIG:-$HOME/.kube/config}"
  HELM_CONFIG_HOME: "${XDG_CONFIG_HOME:-$HOME/.config}/helm"
  HELM_DATA_HOME: "${XDG_DATA_HOME:-$HOME/.local/share}/helm"
  HELM_CACHE_HOME: "${XDG_CACHE_HOME:-$HOME/.cache}/helm"

# Shell aliases
aliases:
  # kubectl aliases
  k: "kubectl"
  kd: "kubectl describe"
  kg: "kubectl get"
  kl: "kubectl logs"
  kx: "kubectl exec -it"
  kdel: "kubectl delete"
  kaf: "kubectl apply -f"
  kdf: "kubectl delete -f"
  # Common resources
  kgp: "kubectl get pods"
  kgs: "kubectl get services"
  kgd: "kubectl get deployments"
  kgn: "kubectl get nodes"
  kgcm: "kubectl get configmaps"
  kgsec: "kubectl get secrets"
  # Context and namespace
  kctx: "kubectl config current-context"
  kns: "kubectl config view --minify --output jsonpath={..namespace}"
  kgctx: "kubectl config get-contexts"
  kgns: "kubectl get namespaces"
  # Helm aliases
  hm: "helm"
  hls: "helm list"
  hla: "helm list -A"
  hin: "helm install"
  hup: "helm upgrade"
  hun: "helm uninstall"
  hval: "helm get values"
  hs: "helm search"
  hsr: "helm search repo"
  # k9s shortcut
  k9: "k9s"

# Wrapper functions
wrappers:
  - name: kinfo
    command: "acorn k8s info"

  - name: kpods
    command: "acorn k8s pods"

  - name: kuse
    command: "acorn k8s context"

  - name: knsuse
    command: "acorn k8s namespace"

  - name: kall
    command: "acorn k8s all"

  - name: kcleanpods
    command: "acorn k8s clean"

# Shell functions (interactive kubectl commands)
shell_functions:
  # Get pod logs with follow
  klf: |
    if [ -z "$1" ]; then
        echo "Usage: klf <pod-name> [container]"
        return 1
    fi
    if [ -n "$2" ]; then
        kubectl logs -f "$1" -c "$2"
    else
        kubectl logs -f "$1"
    fi

  # Port forward helper
  kpf: |
    if [ -z "$2" ]; then
        echo "Usage: kpf <pod-name> <local-port:remote-port>"
        return 1
    fi
    kubectl port-forward "$1" "$2"

  # Exec into pod
  ksh: |
    if [ -z "$1" ]; then
        echo "Usage: ksh <pod-name> [command]"
        return 1
    fi
    local cmd="${2:-/bin/sh}"
    kubectl exec -it "$1" -- "$cmd"

  # Watch pods
  kwatch: |
    kubectl get pods -w "$@"
