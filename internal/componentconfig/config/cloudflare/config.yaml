# CloudFlare component configuration
name: cloudflare
description: CloudFlare CLI (wrangler) integration for Workers, Pages, R2, KV, and D1
version: 1.0.0

# Environment variables
env:
  WRANGLER_HOME: "${XDG_CONFIG_HOME:-$HOME/.config}/wrangler"

# Shell aliases
aliases:
  # Core wrangler aliases
  wr: "wrangler"
  wrd: "wrangler dev"
  wrp: "wrangler pages"
  wrr2: "wrangler r2"
  wrkv: "wrangler kv"
  # Workers management
  wrlist: "wrangler deployments list"
  wrtail: "wrangler tail"
  wrpub: "wrangler deploy"
  # Pages management
  wrplist: "wrangler pages project list"
  wrpdeploy: "wrangler pages deploy"
  # R2 storage
  wrr2list: "wrangler r2 bucket list"
  # KV storage
  wrkvlist: "wrangler kv namespace list"
  # D1 database
  wrd1: "wrangler d1"
  wrd1list: "wrangler d1 list"
  # Secrets management
  wrsecret: "wrangler secret"
  wrsecrets: "wrangler secret list"
  # Login/logout
  wrlogin: "wrangler login"
  wrlogout: "wrangler logout"
  wrwhoami: "wrangler whoami"

# Wrapper functions
wrappers:
  - name: cf_status
    command: "acorn cf status"

  - name: cf_whoami
    command: "acorn cf whoami"

  - name: cf_workers
    command: "acorn cf workers"

  - name: cf_pages
    command: "acorn cf pages"

  - name: cf_r2_buckets
    command: "acorn cf r2 list"

  - name: cf_kv_namespaces
    command: "acorn cf kv list"

  - name: cf_d1_databases
    command: "acorn cf d1 list"

  - name: cf_logs
    command: "acorn cf logs"

  - name: cf_deploy
    command: "acorn cf deploy"

  - name: cf_worker_init
    command: "acorn cf init worker"

  - name: cf_pages_init
    command: "acorn cf init pages"

  - name: cf_r2_create
    command: "acorn cf r2 create"

  - name: cf_kv_create
    command: "acorn cf kv create"

  - name: cf_d1_create
    command: "acorn cf d1 create"

  - name: cf_secret_put
    command: "acorn cf secret-put"

  - name: cf_secrets
    command: "acorn cf secrets"

  - name: cf_overview
    command: "acorn cf overview"

  - name: cf_login
    command: "acorn cf login"

  - name: cf_logout
    command: "acorn cf logout"

# Shell functions
shell_functions:
  # Ensure wrangler config directory exists
  _cloudflare_init: |
    if [ ! -d "${WRANGLER_HOME}" ]; then
        mkdir -p "${WRANGLER_HOME}" 2>/dev/null
    fi

  # Show help
  cf_help: |
    echo "CloudFlare Component Functions"
    echo "---"
    echo ""
    echo "Status & Info:"
    echo "  cf_status           Check CLI status and auth"
    echo "  cf_whoami           Show current account"
    echo "  cf_overview         Overview of all resources"
    echo ""
    echo "List Resources:"
    echo "  cf_workers          List Workers"
    echo "  cf_pages            List Pages projects"
    echo "  cf_r2_buckets       List R2 buckets"
    echo "  cf_kv_namespaces    List KV namespaces"
    echo "  cf_d1_databases     List D1 databases"
    echo ""
    echo "Create Resources:"
    echo "  cf_worker_init      Create new Worker project"
    echo "  cf_pages_init       Create new Pages project"
    echo "  cf_r2_create        Create R2 bucket"
    echo "  cf_kv_create        Create KV namespace"
    echo "  cf_d1_create        Create D1 database"
    echo ""
    echo "Operations:"
    echo "  cf_deploy           Deploy current worker"
    echo "  cf_logs <worker>    Tail worker logs"
    echo "  cf_secret_put       Add worker secret"
    echo "  cf_secrets          List worker secrets"
    echo ""
    echo "Aliases:"
    echo "  wr, wrd, wrp, wrr2, wrkv, wrd1"
    echo "  wrlogin, wrlogout, wrwhoami"
